<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
<meta name="viewport" content="target-densitydpi=device-dpi, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">    
 <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">   
    
<title>Pongo+</title>
</head>

<body>
 <center>   <div id="title" style="background:#9CC;" >
        <h1 style="color:#960">Pongo+</h1>
    </div></center>
    <center><div id="fen">
    <input type="button" id="dangqianchengji" value="当前成绩" style="width:150px;color:#C00;background:#6FF"/>
    <input type="button" id="zuihaochengji" value="最好成绩"  style="width:150px;color:#C00;background:#6FF"/>
    </div></center>
<center><canvas id="pane" width="300" height="320" style="background:rgb(240,222,185)" onTouchStart="changelinedirection()">
很抱歉，您的浏览器不支持我的游戏哦~
</canvas></center>
<div><br></div>
<center><input type="button" id="startgame" onclick="startgame()" value="再来一次！"/></center>
<center><h4 style="color:#30F">Just for fun By Reason</h4></center>
<script language="javascript">



var maxgrade=0,grade=0;
var gamespeed=1;//小球速度
var linespeed=Math.PI/85;
var crashdistance=15;
var gamedirection={
	shang	: 1,
	xia		: 5,
	zuo		: 7,
	you		: 3,
	zuoshang: 8,
	zuoxia	: 6,
	youshang: 2,
	youxia	: 4,
	clock	: 0,
	anticlock: 9,
	};//方向

var canvas={
	width : 300,
	height: 320,
	};//画布
	
var bigcircle = {//大圆参数
        x : 0,    //圆心的x轴坐标值
        y : 0,    //圆心的y轴坐标值
        r : 150,  //圆的半径
		c : 'rgb(255,255,255)',   
    };//大圆

var smallcircle = {//小圆参数
        x : 0,    //圆心的x轴坐标值
        y : 0,    //圆心的y轴坐标值
        r : 12,  //圆的半径
		c : 'rgb(204,105,106)',
		direction :  gamedirection.xia,
    };//小圆
	
var line = {//挡板线的参数
	x : 0,    //圆心的x轴坐标值
    y : 0,    //圆心的y轴坐标值
    r : 150 ,  //圆弧的半径
 start:(Math.PI/2-Math.PI/32),
  end :	(Math.PI/2+Math.PI/32),
	c : 'rgb(55,55,55)',
	direction: gamedirection.anticlock,
	};//跟踪线

var dot = {//跟踪点参数
	x	:	(bigcircle.r*Math.cos(line.start+Math.PI/16)),//以大圆为原点
	y	:	(bigcircle.r*Math.sin(line.start+Math.PI/16)),
	r	:	1,
	}//跟踪点
/*
var dot1 = {//跟踪点参数
	x	:	(bigcircle.r*Math.cos(line.start+Math.PI/16)),//以大圆为原点
	y	:	(bigcircle.r*Math.sin(line.start+Math.PI/16)),
	r	:	1,
	}//跟踪点	
var dot2 = {//跟踪点参数
	x	:	(bigcircle.r*Math.cos(line.start+Math.PI/16)),//以大圆为原点
	y	:	(bigcircle.r*Math.sin(line.start+Math.PI/16)),
	r	:	1,
	}//跟踪点	
*/
	
function changelinedirection()
{
	if(line.direction==gamedirection.clock)
	{
		line.direction=gamedirection.anticlock;
	}
	else
	{
		line.direction=gamedirection.clock;
	}
}
var objpane=document.getElementById("pane");
var ctxpane=objpane.getContext("2d");
ctxpane.translate(150,150);//必备 画布中心点平移

	
function getdistance(){
	var distance=(smallcircle.x - bigcircle.x)*(smallcircle.x - bigcircle.x)+(smallcircle.y - bigcircle.y)*(smallcircle.y - bigcircle.y);
	return distance;
	}//返回小球与大圆中心距离平方 getdistance()
	
function getangle(){
	var absy=Math.abs(line.y - bigcircle.y);
	var absx=Math.abs(line.x - bigcircle.x);
	var tanangle=absy/absx;
	}	//getangle()

function ifgameover(){//判断是否出界
	if((getdistance() - bigcircle.r*bigcircle.r)>2)
	return true;
	else
	return false;
	}	//判断游戏是否结束 ifgameover()

function ifcrash(){		//碰撞检测
	var dx = dot.x-smallcircle.x;
	var dy = dot.y-smallcircle.y;
	var dd=dx*dx+dy*dy;
	if(dd< crashdistance* crashdistance)
		return true;
	else 
		return false;
	}//碰撞检测 ifcrash()
	
function randomback()
{
	var x=Math.floor(Math.random()*3);
	switch (smallcircle.direction){				//根据小球方向做移动
				case gamedirection.shang:
				{
					switch (x)
					{
						case 0:
						smallcircle.direction=gamedirection.xia;
						break;
						case 1:
						smallcircle.direction=gamedirection.zuoxia;
						break;
						case 2:
						smallcircle.direction=gamedirection.youxia;
						break;
						default:
						break;
					}
				}
				case gamedirection.xia:
				{
					switch (x)
					{
						case 0:
						smallcircle.direction=gamedirection.shang;
						break;
						case 1:
						smallcircle.direction=gamedirection.zuoshang;
						break;
						case 2:
						smallcircle.direction=gamedirection.youshang;
						break;
						default:
						break;					
					}
				}
			    case gamedirection.zuo:
				{
					switch (x)
					{
						case 0:
						smallcircle.direction=gamedirection.you;
						break;
						case 1:
						smallcircle.direction=gamedirection.youshang;
						break;
						case 2:
						smallcircle.direction=gamedirection.youxia;
						break;
						default:
						break;
					}
				}
				case gamedirection.you:
				{
					switch (x)
					{
						case 0:
						smallcircle.direction=gamedirection.zuo;
						break;
						case 1:
						smallcircle.direction=gamedirection.zuoxia;
						break;
						case 2:
						smallcircle.direction=gamedirection.zuoshang;
						break;
						default:
						break;
					}
					
				}
				case gamedirection.zuoshang:
				{
					switch (x)
					{
						case 0:
						smallcircle.direction=gamedirection.youxia;
						break;
						case 1:
						smallcircle.direction=gamedirection.xia;
						break;
						case 2:
						smallcircle.direction=gamedirection.you;
						break;
						default:
						break;
					}
					
				}
				case gamedirection.zuoxia:
				{
					switch (x)
					{
						case 0:
						smallcircle.direction=gamedirection.youshang;
						break;
						case 1:
						smallcircle.direction=gamedirection.shang;
						break;
						case 2:
						smallcircle.direction=gamedirection.you;
						break;
						default:
						break;
					}
					
				}
				case gamedirection.youshang:
				{
					switch (x)
					{
						case 0:
						smallcircle.direction=gamedirection.zuoxia;
						break;
						case 1:
						smallcircle.direction=gamedirection.zuo;
						break;
						case 2:
						smallcircle.direction=gamedirection.xia;
						break;
						default:
						break;
					}
					
				}
				case gamedirection.youxia:
				{
					switch (x)
					{
						case 0:
						smallcircle.direction=gamedirection.zuoshang;
						break;
						case 1:
						smallcircle.direction=gamedirection.zuo;
						break;
						case 2:
						smallcircle.direction=gamedirection.youshang;
						break;
						default:
						break;
					}
					
				}
				default:
				{
					break;		
				}
			}	
}//小球随机反向 randomback()

function smallcircledirection()
{
	switch (smallcircle.direction){				//根据小球方向做移动
				case gamedirection.shang:
				{
					smallcircle.y=smallcircle.y-gamespeed;
					grade++;
					if(grade>maxgrade)
					maxgrade=grade;
				    showgrade();
					break;
				}
				case gamedirection.xia:
				{
					smallcircle.y=smallcircle.y+gamespeed;
					grade++;
					if(grade>maxgrade)
					maxgrade=grade;
				    showgrade();
					break;
				}
				case gamedirection.zuo:
				{
					smallcircle.x=smallcircle.x-gamespeed;
					grade++;
					if(grade>maxgrade)
					maxgrade=grade;
				    showgrade();
					break;
				}
				case gamedirection.you:
				{
					smallcircle.x=smallcircle.x+gamespeed;
					grade++;
					if(grade>maxgrade)
					maxgrade=grade;
				    showgrade();
					break;
				}
				case gamedirection.zuoshang:
				{
					smallcircle.x=smallcircle.x-gamespeed;
					smallcircle.y=smallcircle.y-gamespeed;
					grade++;
					if(grade>maxgrade)
					maxgrade=grade;
				    showgrade();
					break;
				}
				case gamedirection.zuoxia:
				{
					smallcircle.x=smallcircle.x-gamespeed;
					smallcircle.y=smallcircle.y+gamespeed;
					grade++;
					if(grade>maxgrade)
					maxgrade=grade;
				    showgrade();
					break;
				}
				case gamedirection.youshang:
				{
					smallcircle.x=smallcircle.x+gamespeed;
					smallcircle.y=smallcircle.y-gamespeed;
					grade++;
					if(grade>maxgrade)
					maxgrade=grade;
				    showgrade();
					break;
				}
				case gamedirection.youxia:
				{
					smallcircle.x=smallcircle.x+gamespeed;
					smallcircle.y=smallcircle.y+gamespeed;
					grade++;
					if(grade>maxgrade)
					maxgrade=grade;
				    showgrade();
					break;
				}
				default:
				{
					break;		
				}
			}	
}//小球移动 smallcircledirection()

/*画出底部圆*/
ctxpane.beginPath();	//大圆
ctxpane.arc(bigcircle.x,bigcircle.y,bigcircle.r,0,Math.PI*2,true);
ctxpane.fillStyle = bigcircle.c;
ctxpane.fill();
ctxpane.closePath();

/*画出底部追踪线条*/
ctxpane.beginPath();
ctxpane.lineWidth=4;
ctxpane.strokeStyle = line.c;
ctxpane.arc(line.x, line.y, line.r, line.start, line.end,false); 
ctxpane.stroke(); 
ctxpane.closePath();


function showgrade(){
	var grade1=grade/150;
	var grade2=maxgrade/150;
	document.getElementById("dangqianchengji").value="当前成绩为："+(grade1).toFixed(1)+"米";
	document.getElementById("zuihaochengji").value="最好成绩为："+(grade2).toFixed(1)+"米";
	}

function movetest(){
	
	if(ifgameover()&&(!ifcrash()))
	{ 
		clearInterval(timer);
	}
	else
	{
		if(ifcrash())
			{
				randomback();
			//	grade++;
				//if(grade>maxgrade)
			//		maxgrade=grade;
			//	showgrade();
			}		
ctxpane.clearRect(-150,-150,300,320);	//清屏
	
ctxpane.beginPath();	//大圆
ctxpane.arc(bigcircle.x,bigcircle.y,bigcircle.r,0,Math.PI*2,true);
ctxpane.fillStyle = bigcircle.c;
ctxpane.fill();
ctxpane.closePath();

if(line.direction==gamedirection.clock)   //跟踪线顺时针
{
	line.start=line.start + linespeed;	
	line.end=line.end +linespeed;
	ctxpane.beginPath();
	ctxpane.lineWidth=4;
	ctxpane.strokeStyle = line.c;
	ctxpane.arc(line.x, line.y, line.r, line.start, line.end,false); 
	ctxpane.stroke(); 
	ctxpane.closePath();	
}
if(line.direction==gamedirection.anticlock)									//跟踪逆顺时针
{
	line.start=line.start - linespeed;	
	line.end=line.end -linespeed;
	ctxpane.beginPath();
	ctxpane.lineWidth=4;
	ctxpane.strokeStyle = line.c;
	ctxpane.arc(line.x, line.y, line.r, line.start, line.end,false); 
	ctxpane.stroke(); 
	ctxpane.closePath();		
}
	
dot.x=bigcircle.r*Math.cos(line.start+Math.PI/32)	//跟踪点
dot.y=bigcircle.r*Math.sin(line.start+Math.PI/32)
ctxpane.beginPath();//线上跟踪点
ctxpane.arc(dot.x,dot.y,dot.r,0,Math.PI*2,true);
ctxpane.fillStyle = smallcircle.c;
ctxpane.fill();
ctxpane.closePath();	
smallcircledirection();//小圆
//ctxpane.save();
ctxpane.beginPath();
ctxpane.arc(smallcircle.x,smallcircle.y,smallcircle.r,0,Math.PI*2,true);
ctxpane.fillStyle = smallcircle.c;
ctxpane.fill();
ctxpane.closePath();
//ctxpane.restore();
	}
}//主函数

var timer;
function startgame(){//开始游戏
	grade=0;
	showgrade();
	smallcircle.direction=gamedirection.xia;
	smallcircle.x=smallcircle.y=0;
	line.start=Math.PI/2-Math.PI/32;
	line.end=Math.PI/2+Math.PI/32;
	line.direction=gamedirection.anticlock;
	
	clearInterval(timer);
	timer=setInterval(movetest,1);	
	}//开始游戏 startgame() 	

</script>
  <center>  
 <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1000419404'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/z_stat.php%3Fid%3D1000419404%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script></center>   
 
<div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more">分享到：</a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网">人人网</a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{"bdSize":16},"image":{"viewList":["weixin","tsina","qzone","renren"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["weixin","tsina","qzone","renren"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
	</center>

</body>
</html>
